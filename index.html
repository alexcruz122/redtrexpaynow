<!DOCTYPE html>
<html>
<head>
  <title>RedTrex Pay</title>
</head>
<body>

<h2>Pay Now</h2>

<button id="payBtn">Pay 100</button>

<script>
document.getElementById("payBtn").onclick = async () => {
  const payload = {
    order_id: "ORDER123",
    amount: "100",
    currency: "LKR",
    first_name: "Dilanka",
    last_name: "Fernando",
    email: "test@example.com",
    contact_number: "0771234567",
    address_line_one: "Colombo"
  };

  const response = await fetch("https://webxpayipg.onrender.com/create-payment", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(payload)
  });

  // Get backend HTML
  const html = await response.text();

  // Create temporary iframe to execute the HTML safely
  const iframe = document.createElement("iframe");
  iframe.style.width = "100%";
  iframe.style.height = "100%";
  iframe.style.border = "0";

  document.body.innerHTML = "";  // clear old page
  document.body.appendChild(iframe);

  const doc = iframe.contentWindow.document;
  doc.open();
  doc.write(html);
  doc.close();
};
</script>

</body>
</html>
